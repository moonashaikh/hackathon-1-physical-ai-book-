# Data Model: AI-Native Textbook Generation

**Feature Branch**: `1-ai-textbook-gen` | **Date**: 2025-12-05 | **Spec**: specs/1-ai-textbook-gen/spec.md

## Entities

### 1. Chapter

Represents a single chapter within the textbook.

-   **Fields**:
    -   `id`: Unique identifier for the chapter (e.g., integer, slug).
    -   `title`: Title of the chapter (e.g., "Introduction to Physical AI").
    -   `content`: The full markdown content of the chapter.
    -   `order`: Numerical order of the chapter in the textbook.
-   **Relationships**:
    -   Belongs to `TextbookContent`.
-   **Validation Rules**:
    -   `title` and `content` must not be empty.
    -   `order` must be unique and sequential within the `TextbookContent`.

### 2. TextbookContent

Represents the entire collection of chapters forming the textbook.

-   **Fields**:
    -   `id`: Unique identifier for the textbook (e.g., a fixed ID since it's a single book).
    -   `title`: Overall title of the textbook.
    -   `chapters`: A collection of `Chapter` entities, ordered by `Chapter.order`.
-   **Relationships**:
    -   Contains multiple `Chapter` entities.
-   **Validation Rules**:
    -   Must contain exactly 6 `Chapter` entities as per FR-001.

### 3. ChatbotQuestion

Represents a question posed by the user to the RAG chatbot.

-   **Fields**:
    -   `id`: Unique identifier for the question.
    -   `text`: The natural language query from the user.
    -   `context_text`: (Optional) Specific text selected by the user to provide additional context for the question (for text-selection-based Q&A).
    -   `timestamp`: Time when the question was asked.
-   **Relationships**:
    -   Generates a `ChatbotAnswer`.
-   **Validation Rules**:
    -   `text` must not be empty.

### 4. ChatbotAnswer

Represents the answer generated by the RAG chatbot in response to a `ChatbotQuestion`.

-   **Fields**:
    -   `id`: Unique identifier for the answer.
    -   `question_id`: Reference to the `ChatbotQuestion` that prompted this answer.
    -   `answer_text`: The generated response, derived solely from `TextbookContent`.
    -   `source_references`: (Optional) References to specific sections or chapters of the textbook used to formulate the answer.
    -   `timestamp`: Time when the answer was generated.
-   **Relationships**:
    -   Associated with a `ChatbotQuestion`.
    -   Derived from `TextbookContent`.
-   **Validation Rules**:
    -   `answer_text` must not be empty if a valid answer can be provided.
    -   `answer_text` must explicitly state inability to answer if query is out of scope (FR-005).

### 5. UserPreference

Represents user-specific preferences for personalization or translation.

-   **Fields**:
    -   `id`: Unique identifier for the user (e.g., session ID or user ID if authenticated).
    -   `personalization_option`: (Optional) Selected personalization setting (e.g., "simplified language", "detailed examples").
    -   `translation_language`: (Optional) Selected translation language (e.g., "Urdu").
-   **Relationships**:
    -   Influences the presentation of `Chapter` content.
-   **Validation Rules**:
    -   Values for options must be from a predefined set of allowed preferences/languages.